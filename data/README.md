## dem

This folder contains the data and scripts used to generate the water accumulation shapefiles.

- `fetch.sh`: Fetch the Copernicus GLO-30 DEM TIFFs and merge them into a single `dem.tif`
- `tiles.py`: Generate the overlay tiles and datasets including flow directions, water accumulation and catchment basins

To run,

1. Initialize a virtual environment with `python -m venv venv`
2. Activate the venv with `source venv/bin/activate`
3. Install the dependencies with `venv/bin/pip install -r requirements.txt`
4. Run the script with `venv/bin/python tiles.py`

This generates files in the `tiles` folder.

## water-tile-generation

This contains the script to convert the output geojson/shapefile into a PMTiles file. For our analysis, we used the output of the `tiles.py` script and calculated the difference between it and all the 'water' shapes in our bounds to help with layering on the map. You can run the conversion without doing this.

Convert your `stream_influence_reclass.shp` output generated by the earlier `tiles.py` to GeoJSON. With this as your source and run the `./generate_stream_tiles.sh` script.

This outputs a `tiles.pmtiles` file, which we serve from our `static` folder.

## basemap

Instead of querying a remote tile server, we use a local PMTiles file to render the basemap. Files here pull data from OpenStreetMap and convert it into a PMTiles file.
